秘钥
====

WISUN 协议中使用了许多种秘钥, 下面来看下秘钥的生成过程.

参考文档: <802.11i-2004.pdf>

# PTK(Pairwise Transient key)

成对临时秘钥(PTK)是通过PMK秘钥经过[PRF](../ieee80211i_prf/README.md)算法生成的.
流程图如下:

![pmk to ptk](./pic/pmk_to_ptk.png)

生成的PTK被拆分成三部分使用, 分别是 KCK, KEK 和 TK. WISUN 标准中 PTK 是通过
PRF-384 生成的 384bit 的伪随机数, 所以 TK 是 CCMP: L(PTK, 256, 128).

在 [20231128](../wireshark/20231128/README.md) 中记录了一个 PTK 秘钥, 按照这个
格式拆开之后的秘钥如下:

| 类型 | 数值                                            |
| ---- | ----------------------------------------------- |
| KCK  | c7:be:60:74:90:bb:07:16:3a:d8:52:d2:63:cf:c6:6b |
| KEK  | 03:49:14:41:94:68:16:55:ec:5a:b1:d8:f8:45:11:09 |
| TK   | 7e:86:1e:f6:48:e1:64:46:d1:68:92:f1:bb:a2:90:c5 |

